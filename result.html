<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì •ì¹˜ ì„±í–¥ ê²°ê³¼</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f5;
      margin: 0;
      padding: 1rem;
    }
    .container {
      max-width: 700px;
      background: white;
      margin: auto;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 10px #ccc;
      text-align: center;
    }
    canvas {
      max-width: 100%;
      margin-top: 2rem;
    }
    .summary, .ideology {
      margin-top: 2rem;
      text-align: left;
    }
    .btn {
      margin-top: 1.5rem;
      padding: 0.7rem 1.5rem;
      background: #007BFF;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }
    #captureArea {
      background: white;
      padding: 1rem;
      border-radius: 10px;
    }
    .ideology-icon {
      font-size: 2rem;
      margin-right: 10px;
    }
    .ideology-box {
      border-left: 5px solid #007BFF;
      padding-left: 1rem;
      margin-top: 1rem;
    }
    .more-link {
      display: inline-block;
      margin-top: 0.5rem;
      color: #007BFF;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ì •ì¹˜ ì„±í–¥ ê²°ê³¼ ìš”ì•½</h1>
    <div id="captureArea">
      <canvas id="resultChart"></canvas>
      <div class="summary" id="resultText"></div>
      <div class="ideology ideology-box" id="ideologyText"></div>
    </div>
    <button class="btn" onclick="downloadImage()">ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°</button>
  </div>

  <script>
    const qs = new URLSearchParams(window.location.search);
    const result = {
      economic: parseFloat(qs.get('economic')),
      welfare: parseFloat(qs.get('welfare')),
      diversity: parseFloat(qs.get('diversity')),
      security: parseFloat(qs.get('security')),
      order: parseFloat(qs.get('order'))
    };

    const ctx = document.getElementById('resultChart');
    new Chart(ctx, {
      type: 'radar',
      data: {
        labels: ['ì‹œì¥ê²½ì œ', 'ë³µì§€', 'ë‹¤ì–‘ì„±', 'ì•ˆë³´', 'ì§ˆì„œ'],
        datasets: [{
          label: 'ë‹¹ì‹ ì˜ ì •ì¹˜ ì„±í–¥',
          data: [
            result.economic,
            result.welfare,
            result.diversity,
            result.security,
            result.order
          ],
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 2
        }]
      },
      options: {
        scales: {
          r: {
            suggestedMin: 1,
            suggestedMax: 5,
            ticks: { stepSize: 1 }
          }
        }
      }
    });

    const explain = (score, high, low) => {
      if (score >= 4) return high + ' (ë§¤ìš° ê°•í•¨)';
      if (score >= 3.5) return high + ' (ê°•í•¨)';
      if (score >= 2.5) return 'ì¤‘ë„ì  ì„±í–¥';
      if (score >= 2) return low + ' (ê°•í•¨)';
      return low + ' (ë§¤ìš° ê°•í•¨)';
    };

    const summary = `
      <h3>í•´ì„¤</h3>
      <ul>
        <li><b>ì‹œì¥ê²½ì œ:</b> ${explain(result.economic, 'ì‹œì¥ ììœ  ì¤‘ì‹œ', 'ì •ë¶€ ê°œì… ì§€ì§€')}</li>
        <li><b>ë³µì§€:</b> ${explain(result.welfare, 'ë³µì§€ í™•ëŒ€ ì§€ì§€', 'ê°œì¸ ì±…ì„ ê°•ì¡°')}</li>
        <li><b>ë‹¤ì–‘ì„±:</b> ${explain(result.diversity, 'ë‹¤ì–‘ì„± í¬ìš©', 'ë³´ìˆ˜ì  ì ‘ê·¼')}</li>
        <li><b>ì•ˆë³´:</b> ${explain(result.security, 'ì•ˆë³´ ìš°ì„ ', 'ììœ  ìš°ì„ ')}</li>
        <li><b>ì§ˆì„œ:</b> ${explain(result.order, 'ì§ˆì„œ ìœ ì—°ì„± ì§€í–¥', 'ì „í†µ ì§ˆì„œ ì¤‘ì‹œ')}</li>
      </ul>
    `;
    document.getElementById('resultText').innerHTML = summary;

    const ideologyLinks = {
      "ê¶Œìœ„ì£¼ì˜ì  ë³´ìˆ˜ì£¼ì˜": "authoritarian-conservatism.html",
      "ììœ ì§€ìƒì£¼ì˜": "libertarianism.html",
      "ì§„ë³´ì  ììœ ì£¼ì˜": "progressive-liberalism.html",
      "ì‚¬íšŒë¯¼ì£¼ì£¼ì˜": "social-democracy.html",
      "ì¤‘ë„ìš°íŒŒ": "center-right.html",
      "ì¢ŒíŒŒ ê¶Œìœ„ì£¼ì˜": "left-authoritarian.html",
      "ì¤‘ë„ ììœ ì£¼ì˜": "moderate-liberalism.html",
      "ë³´ìˆ˜ ììœ ì£¼ì˜": "right-libertarian.html",
      "ì§„ë³´ ì‚¬íšŒì£¼ì˜": "left-progressive.html",
      "ì¤‘ë„": "centrist.html"
    };

    const icons = {
      "ê¶Œìœ„ì£¼ì˜ì  ë³´ìˆ˜ì£¼ì˜": "ğŸ”’",
      "ììœ ì§€ìƒì£¼ì˜": "ğŸ•Šï¸",
      "ì§„ë³´ì  ììœ ì£¼ì˜": "ğŸŒˆ",
      "ì‚¬íšŒë¯¼ì£¼ì£¼ì˜": "ğŸ¤",
      "ì¤‘ë„ìš°íŒŒ": "âš–ï¸",
      "ì¢ŒíŒŒ ê¶Œìœ„ì£¼ì˜": "ğŸ›¡ï¸",
      "ì¤‘ë„ ììœ ì£¼ì˜": "ğŸ”",
      "ë³´ìˆ˜ ììœ ì£¼ì˜": "ğŸ›ï¸",
      "ì§„ë³´ ì‚¬íšŒì£¼ì˜": "ğŸŒ¿",
      "ì¤‘ë„": "ğŸ§­"
    };

    let ideology = "ì¤‘ë„";
    let desc = "ë‹¹ì‹ ì€ ë‹¤ì–‘í•œ ì´ë… ìŠ¤í™íŠ¸ëŸ¼ì—ì„œ ê· í˜• ì¡íŒ ì…ì¥ì„ ì·¨í•˜ë©°, ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ íŒë‹¨í•©ë‹ˆë‹¤.";
    let figures = "ë²„ë½ ì˜¤ë°”ë§ˆ, ì•™ê²”ë¼ ë©”ë¥´ì¼ˆ";

    const { economic: e, welfare: w, diversity: d, security: s, order: o } = result;

    if (e >= 4 && w <= 2 && d <= 2 && s >= 4 && o >= 4) {
      ideology = "ê¶Œìœ„ì£¼ì˜ì  ë³´ìˆ˜ì£¼ì˜";
      desc = "ì§ˆì„œ, ì•ˆë³´, ì „í†µì„ ì¤‘ì‹œí•˜ë©° ê°•í•œ ì •ë¶€ í†µì œë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤.";
      figures = "ë¸”ë¼ë””ë¯¸ë¥´ í‘¸í‹´, ë°•ì •í¬";
    } else if (e >= 4 && w <= 2 && d >= 4 && s <= 2 && o <= 2) {
      ideology = "ììœ ì§€ìƒì£¼ì˜";
      desc = "ì‹œì¥ì˜ ììœ ì™€ ê°œì¸ì˜ ììœ ë¥¼ ê·¹ë„ë¡œ ì¤‘ì‹œí•˜ë©° ì •ë¶€ ê°œì…ì„ ìµœì†Œí™”í•˜ë ¤ í•©ë‹ˆë‹¤.";
      figures = "ë¡œë²„íŠ¸ ë…¸ì§, ë¡  í´";
    } else if (e <= 2 && w >= 4 && d >= 4 && s <= 2 && o <= 2) {
      ideology = "ì§„ë³´ì  ììœ ì£¼ì˜";
      desc = "ì‚¬íšŒì  ë‹¤ì–‘ì„±ê³¼ í‰ë“±, ì•½ì ë³´í˜¸ë¥¼ ì§€ì§€í•˜ë©° ììœ ë¡œìš´ ì‚¬íšŒë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.";
      figures = "ì•Œë ‰ì‚°ë“œë¦¬ì•„ ì˜¤ì¹´ì‹œì˜¤-ì½”ë¥´í…Œì¦ˆ, ë…¸ì—„ ì´˜ìŠ¤í‚¤";
    } else if (e <= 2 && w >= 4 && d <= 2 && s >= 4 && o >= 4) {
      ideology = "ì‚¬íšŒë¯¼ì£¼ì£¼ì˜";
      desc = "ë³µì§€ë¥¼ í†µí•œ í‰ë“±ì„ ì¶”êµ¬í•˜ì§€ë§Œ, ì•ˆë³´ì™€ ì§ˆì„œë„ ì¤‘ì‹œí•˜ëŠ” ì„±í–¥ì…ë‹ˆë‹¤.";
      figures = "ì˜¬ë¼í”„ ìˆ„ì¸ , í”„ë‘ìˆ˜ì•„ ë¯¸í…Œë‘";
    } else if (e >= 4 && w <= 2 && d >= 3.5 && s >= 4 && o <= 2.5) {
      ideology = "ì¤‘ë„ìš°íŒŒ";
      desc = "ì‹œì¥ê²½ì œì™€ ê°œì¸ ì±…ì„ì„ ì¤‘ì‹œí•˜ë©´ì„œë„, ì¼ë¶€ ì‚¬íšŒì  ë‹¤ì–‘ì„±ì€ ìˆ˜ìš©í•©ë‹ˆë‹¤.";
      figures = "ì—ë§ˆë‰˜ì—˜ ë§ˆí¬ë¡±, ë°ì´ë¹„ë“œ ìºë¨¸ëŸ°";
    } else if (e <= 2 && w >= 4 && d >= 4 && s >= 4 && o >= 4) {
      ideology = "ì¢ŒíŒŒ ê¶Œìœ„ì£¼ì˜";
      desc = "í‰ë“±ê³¼ ë³µì§€ë¥¼ ì¤‘ì‹œí•˜ì§€ë§Œ, ì§ˆì„œì™€ í†µì œì˜ í•„ìš”ì„±ë„ ì¸ì •í•©ë‹ˆë‹¤.";
      figures = "ìš°ê³  ì°¨ë² ìŠ¤, í ë¦­ìŠ¤ ë””ì•„ì¦ˆ";
    } else if (e >= 3 && e <= 3.5 && w >= 3 && w <= 3.5 && d >= 3 && d <= 3.5) {
      ideology = "ì¤‘ë„ ììœ ì£¼ì˜";
      desc = "ì¤‘ë„ì˜ ì…ì¥ì—ì„œ ììœ ì™€ ë³µì§€ì˜ ê· í˜•ì„ ì¶”êµ¬í•©ë‹ˆë‹¤.";
      figures = "ì €ìŠ¤í‹´ íŠ¸ë¤¼ë„, ì•ˆì² ìˆ˜";
    } else if (e >= 4 && w <= 2 && d >= 3 && s >= 3 && o >= 3) {
      ideology = "ë³´ìˆ˜ ììœ ì£¼ì˜";
      desc = "ì‹œì¥ê³¼ ê°œì¸ì˜ ììœ ë¥¼ ì¤‘ì‹œí•˜ë©°, ì „í†µê³¼ êµ­ê°€ ì•ˆë³´ì—ë„ ê°€ì¹˜ë¥¼ ë‘¡ë‹ˆë‹¤.";
      figures = "í”„ë¦¬ë“œë¦¬íˆ í•˜ì´ì—í¬, ë°€í„´ í”„ë¦¬ë“œë¨¼";
    } else if (e <= 2 && w >= 4 && d >= 4 && s <= 2.5 && o <= 2.5) {
      ideology = "ì§„ë³´ ì‚¬íšŒì£¼ì˜";
      desc = "ê²½ì œì  ë¶ˆí‰ë“± í•´ì†Œì™€ ì•½ì ë³´í˜¸ë¥¼ ìµœìš°ì„  ê³¼ì œë¡œ ë³´ë©°, ë‹¤ì–‘ì„±ê³¼ ë³µì§€ë¥¼ ê°•ì¡°í•©ë‹ˆë‹¤.";
      figures = "ë²„ë‹ˆ ìƒŒë”ìŠ¤, ì œë ˆë¯¸ ì½”ë¹ˆ";
    }

    const color = {
      "ê¶Œìœ„ì£¼ì˜ì  ë³´ìˆ˜ì£¼ì˜": "#b22222",
      "ììœ ì§€ìƒì£¼ì˜": "#008080",
      "ì§„ë³´ì  ììœ ì£¼ì˜": "#ff69b4",
      "ì‚¬íšŒë¯¼ì£¼ì£¼ì˜": "#006400",
      "ì¤‘ë„ìš°íŒŒ": "#4682b4",
      "ì¢ŒíŒŒ ê¶Œìœ„ì£¼ì˜": "#9932cc",
      "ì¤‘ë„ ììœ ì£¼ì˜": "#1e90ff",
      "ë³´ìˆ˜ ììœ ì£¼ì˜": "#000080",
      "ì§„ë³´ ì‚¬íšŒì£¼ì˜": "#dc143c",
      "ì¤‘ë„": "#696969"
    };

    document.getElementById('ideologyText').innerHTML = `
      <h3><span class="ideology-icon">${icons[ideology] || "ğŸ§­"}</span> <span style="color:${color[ideology] || '#007BFF'}">${ideology}</span></h3>
      <p>${desc}</p>
      <p><b>ëŒ€í‘œì  ì¸ë¬¼:</b> ${figures}</p>
      <a href="${ideologyLinks[ideology] || '#'}" class="more-link" target="_blank">ğŸ‘‰ ë” ìì„¸íˆ ì•Œì•„ë³´ê¸°</a>
    `;

    function downloadImage() {
      html2canvas(document.querySelector("#captureArea")).then(canvas => {
        const link = document.createElement('a');
        link.download = 'political_result.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    }
  </script>
</body>
</html>
